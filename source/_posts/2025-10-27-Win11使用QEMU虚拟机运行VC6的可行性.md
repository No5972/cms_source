---
layout: post
title: "Win11 使用 Copy v86 在线网页运行 VC6 学习 C 语言的可行性"
date: 2025-10-27 11:00:00
categories: 
  - [C/C++]
excerpt: "上次探讨了使用 Copy v86 在线网页运行 VC6 的可行性，但是仍然存在一些缺陷，保存文件不是很方便，不能输入和显示中文，也不能写 MFC 程序（这个和前面那个不能输入和显示中文有关，这个英文版的 VC6 把 MFC 相关的开发环境给精简掉了）。这里再探讨一下可否使用 QEMU 虚拟机在 Win11 运行 VC6。 庆幸的是，有一个很简便的可以导入磁盘镜像一键启动的绿色免安装单文件直接运行的图形界面的工具《QEMU 启动测试器》，可以直接运行 QEMU 虚拟机，这样就不需要安装虚拟机软件了。这个启动的操作比网页版稍微复杂一点点，不过也只是复杂一点点。"
mathjax: true
permalink: /archivers/174
isrepublish: false
---

有些学校或者老师仍然在要求学生必须使用 VC6 来学习 C 语言基础。但是现在的 Win11 已经逐渐开始停止支持 VC6 这个上古时期的 IDE 的运行。 **有的时候不是要建议学生换用现代的 IDE 来学习，而是学校或者老师要求学生必须使用 VC6 这个上古时期的 IDE 来学习，学生是被迫、不得不使用 VC6 的。** 上次探讨了使用 Copy v86 在线网页运行 VC6 的可行性，但是仍然存在一些缺陷，保存文件不是很方便，不能输入和显示中文，也不能写 MFC 程序（这个和前面那个不能输入和显示中文有关，这个英文版的 VC6 把 MFC 相关的开发环境给精简掉了）。这里再探讨一下可否使用 QEMU 虚拟机在 Win11 运行 VC6。 **庆幸的是，有一个很简便的可以导入磁盘镜像一键启动的绿色免安装单文件直接运行的图形界面的工具《QEMU 启动测试器》，可以直接运行 QEMU 虚拟机，这样就不需要安装虚拟机软件了。** 这个启动的操作比网页版稍微复杂一点点，不过也只是复杂一点点。

鄙人这里也已经封装好了一个磁盘镜像，不过鄙人还没研究出来怎么搞快照，印象中 QEMU 也有快照功能（参考鄙人以前发的飞腾提供的 PhyFusion，那个就有快照功能，这个本质上就是 QEMU 的一个 GUI 封装），所以每次使用的时候还是要完整的开机一次。鄙人是找了一个“贝贝精简系统 BABEXP-V0.14-H 最小中文家庭版”的精简版 XP 系统，这个系统包只有 75MB，安装后 C 盘占用 1 点多 GB，用 7z 压缩磁盘镜像之后只有不到 80MB。这个支持显示和输入中文，输入法还是保留了一个智能 ABC 的，虽然这个打字不是很方便，但是用于学习 C 语言编程也够用了。[感谢 B 站的 @Moemuu 提供的线索](https://www.bilibili.com/video/BV1184y1F7B2/)。

**具体操作过程：到网上找到这个《QEMU 启动测试器》，这个就是一个免安装的单文件 EXE，双击打开直接就可以使用。把下载好的磁盘镜像压缩包解压，此时会得到一个 400 多 MB 的 ```.qcow2``` 的文件，这个就是磁盘镜像。打开那个“Q启动测试.exe”，上面的选项里面选择第二行第一个“磁盘镜像”，然后直接把这个 400 多 MB 的 ```.qcow2``` 的文件拖放到这个窗口的中间的文本框里面，内存大小输入 1000 或者 1024 都可以（别太大太小就行，太大了物理机电脑可能带不动，太小了虚拟机可能带不动）。然后点击“开始测试”，静候开机，看到桌面之后，桌面上就有一个“VC666”的图标，直接打开就能运行和使用 VC6 了。这个可以显示中文，界面也是中文版的，也可以用智能 ABC 输入法输入中文，也可以写控制台和 MFC 程序。这个启动器是会直接写入磁盘镜像的，也就是说编写的代码保存之后，下次开机还是保存在虚拟机上的。**

![image](https://images.weserv.nl/?url=https://img2024.cnblogs.com/blog/2259503/202510/2259503-20251027174803301-1377498548.png)

![image](https://images.weserv.nl/?url=https://img2024.cnblogs.com/blog/2259503/202510/2259503-20251027174814292-1229761202.png)

![image](https://images.weserv.nl/?url=https://img2024.cnblogs.com/blog/2259503/202510/2259503-20251027174823741-53834603.png)

![image](https://images.weserv.nl/?url=https://img2024.cnblogs.com/blog/2259503/202510/2259503-20251027174847129-2086274837.png)

如果不放心现成的磁盘镜像，或者一定想自己动手配置的话，下面是从头开始配置的过程：

1. 下载安装 QEMU Manager 这个工具，点击工具栏第一个按钮虚拟机。
  - 虚拟机名字随便起一个，操作系统选 Windows XP，其他保持默认。
  - 内存大小填 1000 或者 1024，主要虚拟硬盘选创建一个新的虚拟磁盘镜像，磁盘大小选 2GB，勾选压缩磁盘，格式选 qcow2。
  - 第三个选项勾不勾都行，个人建议还是勾上，方便管理。
2. 左侧树形图选择刚才创建的虚拟机，右侧选择驱动器，双击 CD-ROM，点击右侧两个点的按钮，找到前述所说的“贝贝精简系统 BABEXP-V0.14-H 最小中文家庭版”的精简版 XP 系统的 ISO 文件，确定。
3. 然后点击工具栏的播放按钮开机，立刻点进去虚拟机的显示画面并立刻连续击键 F12，打开启动菜单，按主键盘区的数字键“3”从虚拟机的光驱启动。
4. 按照这个系统包的安装过程走一遍，把这个精简版 XP 系统装到虚拟机的磁盘上。
5. 还是用 UltraISO 往虚拟机里面传输文件，需要准备这些：
  - VC6 绿色版压缩包，这里准备的是一个 50 多 MB 的，名字可能不好找，大致搜索一下“VC6 绿色版”应该可以找到。压缩包是 ZIP 格式的，大小是 55,066,220 字节，MD5 码是 ```c1fad870bfc969f57679a85196fc6043```。把准备好的文件直接拖到 UltraISO 的右上方的窗格里面。然后把这个文档保存为 ISO 文件。
  - 一个 XP 可用的 7-Zip 安装包，这里找了一个 9.22 的版本。
6. 安装好之后重启一遍虚拟机，把弹出来几个找到新硬件的向导全部一路 next，这些驱动都被精简掉了，主要是声卡、网卡这些，不过不影响 VC6 写代码（涉及多媒体的程序确实不行就是）。
7. 关闭虚拟机，还是右侧选择驱动器，双击 CD-ROM，点击右侧两个点的按钮，找到并选择刚才在 UltraISO 里面保存的 ISO 文件，确定。
8. 打开虚拟机，打开“我的电脑”，打开里面的光盘，先把里面的 7-zip 安装包安装，一路 next 就行。然后右键那个 VC6 绿色版的压缩包，选择 7-Zip - 提取文件，解压到 C 盘的任意位置。
9. 找到解压缩出来的地方，打开里面的 ```VC6.0green\Common\MSDev98\Bin\MSDEV.EXE```，右键发送到 - 桌面快捷方式，然后把桌面上创建出来的这个 VC6 的快捷方式重命名一下。以后就可以用这个快捷方式运行和使用 VC6 了。
10. 建议把这个磁盘镜像备份一下，以后方便重置环境。关闭虚拟机，把这个 ```.qcow2``` 的磁盘镜像文件压缩成一个压缩包文件即可。