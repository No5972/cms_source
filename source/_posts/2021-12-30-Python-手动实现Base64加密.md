---
layout: post
title: "Python 手动实现 Base64 加密"
date: 2021-12-30 13:00:00
categories: 
  - [Python]
excerpt: "前段时间看了某篇报纸文章，讲解在 Python 中加密 Base64 的程序。然而那片文章完全只是调用 base64 这个包。Python 调包是相当方便，但是这样除了调包还是调包，根本达不到锻炼编码能力的效果。用人单位招人面试可不看你怎么调包，很多都是自己要手撕实现的。现在的 IT 开发岗位就是这么卷。这里研究一下在 Python 怎么手动实现 Base 加密。"
mathjax: true
permalink: /archivers/118
isrepublish: false
---

前段时间看了某篇报纸文章，讲解在 Python 中加密 Base64 的程序。然而那片文章完全只是调用 ```base64``` 这个包。Python 调包是相当方便，但是这样除了调包还是调包，根本达不到锻炼编码能力的效果。用人单位招人面试可不看你怎么调包，很多都是自己要手撕实现的。现在的 IT 开发岗位就是这么卷。

这里研究一下在 Python 怎么手动实现 Base 加密。

要求：使用 Python 语言实现一个函数 ```base64(src)``` ，参数是一个字符串，返回的也是一个字符串，是参数中的字符串经过 Base64 加密得到的加密后的字符串。禁止使用 ```import``` 。

程序：
```python
def base64(src):
    alphabet = b"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
    ret = bytearray()
    length = len(src)
    # r记录补0的个数
    r = 0
    for offset in range(0, length,3):
        if offset + 3 <= length:
            triple = src[offset:offset + 3]
        else:
            triple = src[offset:]
            r = 3 - len(triple)
            triple = triple + '\x00' * r
        
        b = int.from_bytes(triple.encode(), 'big')
 
        for i in range(18, -1, -6):
            if i == 18:
                index = b >> i
            else:
                index = b >> i & 0x3F
            ret.append(alphabet[index])
 
        for i in range(1, r + 1):
            ret[-i] = 0x3D
  return ret.decode('utf-8')
```

测试：
```python
print(base64('abcde')) # 输出：YWJjZGU=
```